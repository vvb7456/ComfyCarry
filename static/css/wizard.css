        :root {
            --bg1: #0a0a0f;
            --bg2: #12121e;
            --bg3: #1a1a28;
            --bg4: #22223a;
            --bd: #2a2a3e;
            --t1: #e8e8f0;
            --t2: #a8a8c0;
            --t3: #68688a;
            --accent: #7c5cfc;
            --accent2: #9078ff;
            --green: #4ade80;
            --red: #f87171;
            --amber: #f59e0b;
            --r: 12px;
            --mono: 'IBM Plex Mono', 'Fira Code', monospace;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'IBM Plex Sans', 'IBM Plex Sans SC', -apple-system, sans-serif;
            background: var(--bg1);
            color: var(--t1);
            min-height: 100vh;
            font-size: clamp(15px, 1vw, 18px);
        }

        .wizard-container {
            max-width: 960px;
            margin: 0 auto;
            padding: clamp(24px, 4vw, 60px) clamp(16px, 3vw, 40px);
        }

        .wizard-header {
            text-align: center;
            margin-bottom: clamp(24px, 3vw, 48px);
        }

        .wizard-header h1 {
            font-size: clamp(1.6rem, 2.5vw, 2.4rem);
            font-weight: 700;
            background: linear-gradient(135deg, #7c5cfc, #e879f9);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .wizard-header p {
            color: var(--t3);
            font-size: clamp(0.85rem, 1vw, 1.05rem);
            margin-top: 8px;
        }

        /* Progress bar */
        .progress-bar {
            display: flex;
            gap: 6px;
            margin-bottom: clamp(24px, 3vw, 40px);
        }

        .progress-segment {
            flex: 1;
            height: 5px;
            border-radius: 3px;
            background: var(--bg4);
            transition: background .3s;
        }

        .progress-segment.done {
            background: var(--accent);
        }

        .progress-segment.active {
            background: var(--accent2);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: .5
            }
        }

        /* Steps */
        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        .step-title {
            font-size: clamp(1.1rem, 1.5vw, 1.5rem);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .step-desc {
            color: var(--t2);
            font-size: clamp(0.88rem, 1vw, 1.05rem);
            margin-bottom: 24px;
            line-height: 1.6;
        }

        /* Cards for selection */
        .choice-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .choice-grid.rclone-cards {
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }

        .choice-grid.rclone-cards .choice-card {
            padding: clamp(12px, 1.5vw, 20px);
        }

        .choice-grid.rclone-cards .choice-card h3 {
            font-size: clamp(.88rem, 1vw, 1.05rem);
            margin-bottom: 4px;
        }

        .choice-grid.rclone-cards .choice-card p {
            font-size: clamp(.75rem, .85vw, .88rem);
        }

        .choice-card {
            background: var(--bg3);
            border: 2px solid var(--bd);
            border-radius: var(--r);
            padding: clamp(16px, 2vw, 28px);
            cursor: pointer;
            transition: all .2s;
            position: relative;
        }

        .choice-card:hover {
            border-color: var(--accent);
        }

        .choice-card.selected {
            border-color: var(--accent);
            background: color-mix(in srgb, var(--accent) 10%, var(--bg3));
        }

        .choice-card h3 {
            font-size: clamp(0.95rem, 1.1vw, 1.15rem);
            margin-bottom: 8px;
        }

        .choice-card p {
            font-size: clamp(0.82rem, 0.95vw, 1rem);
            color: var(--t3);
            line-height: 1.5;
        }

        .choice-card .badge {
            display: inline-block;
            font-size: clamp(0.65rem, 0.7vw, 0.78rem);
            background: var(--accent);
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 6px;
        }

        /* Form inputs */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: clamp(0.88rem, 1vw, 1.05rem);
            color: var(--t2);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: clamp(10px, 1.2vw, 16px) clamp(14px, 1.5vw, 20px);
            background: var(--bg2);
            color: var(--t1);
            border: 1px solid var(--bd);
            border-radius: 10px;
            font-size: clamp(0.9rem, 1vw, 1.05rem);
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: var(--accent);
            outline: none;
        }

        .form-group textarea {
            min-height: 100px;
            font-family: var(--mono);
            font-size: clamp(0.82rem, 0.9vw, 0.95rem);
            resize: vertical;
        }

        .form-hint {
            font-size: clamp(0.78rem, 0.85vw, 0.92rem);
            color: var(--t3);
            margin-top: 6px;
            line-height: 1.5;
        }

        /* Buttons */
        .btn-row {
            display: flex;
            gap: 14px;
            margin-top: 28px;
        }

        .btn {
            padding: clamp(10px, 1.3vw, 16px) clamp(24px, 2.5vw, 36px);
            border: none;
            border-radius: 10px;
            font-size: clamp(0.92rem, 1vw, 1.1rem);
            cursor: pointer;
            font-weight: 600;
            transition: all .15s;
        }

        .btn-primary {
            background: var(--accent);
            color: #fff;
        }

        .btn-primary:hover {
            background: var(--accent2);
        }

        .btn-secondary {
            background: var(--bg4);
            color: var(--t2);
        }

        .btn-secondary:hover {
            background: var(--bd);
        }

        .btn-lg {
            padding: clamp(14px, 1.5vw, 20px) clamp(32px, 3vw, 48px);
            font-size: clamp(1rem, 1.2vw, 1.2rem);
        }

        .btn:disabled {
            opacity: .5;
            cursor: not-allowed;
        }

        /* Plugin list */
        .plugin-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--bd);
            border-radius: var(--r);
        }

        .plugin-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: clamp(10px, 1.2vw, 16px) clamp(14px, 1.5vw, 20px);
            border-bottom: 1px solid var(--bd);
            font-size: clamp(0.88rem, 1vw, 1.05rem);
        }

        .plugin-item:last-child {
            border-bottom: none;
        }

        .plugin-item input[type="checkbox"] {
            accent-color: var(--accent);
            width: 18px;
            height: 18px;
        }

        .plugin-item .plugin-name {
            flex: 1;
        }

        .plugin-item .plugin-required {
            font-size: clamp(0.7rem, 0.8vw, 0.85rem);
            color: var(--accent);
        }

        /* Radio group for rclone */
        .radio-group {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: clamp(0.88rem, 1vw, 1.05rem);
            color: var(--t2);
            cursor: pointer;
        }

        .radio-group input[type="radio"] {
            accent-color: var(--accent);
            width: 16px;
            height: 16px;
        }

        /* Environment info card */
        .env-card {
            background: var(--bg3);
            border: 1px solid var(--bd);
            border-radius: var(--r);
            padding: clamp(14px, 1.5vw, 24px);
            margin-bottom: 20px;
        }

        .env-card .env-row {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .env-card .env-row+.env-row {
            margin-top: 8px;
        }

        .env-card .env-label {
            color: var(--t3);
            font-size: .82rem;
            min-width: 60px;
            white-space: nowrap;
        }

        .env-card .env-value {
            font-weight: 600;
            font-size: clamp(.92rem, 1vw, 1.1rem);
        }

        .env-card .env-divider {
            border: none;
            border-top: 1px solid var(--bd);
            margin: 10px 0;
        }

        .env-card .env-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 4px;
        }

        .env-card .env-tag {
            font-size: .75rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--bg4);
            color: var(--t2);
            border: 1px solid var(--bd);
        }

        .env-card .env-tag.green {
            color: var(--green);
            border-color: var(--green);
        }

        /* Password input wrapper */
        .pw-wrap {
            position: relative;
        }

        .pw-wrap input {
            padding-right: 42px;
        }

        .pw-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--t3);
            cursor: pointer;
            font-size: 1.1rem;
            padding: 4px;
        }

        .pw-toggle:hover {
            color: var(--t1);
        }

        .pw-mismatch {
            color: var(--red);
            font-size: .82rem;
            margin-top: 4px;
            display: none;
        }

        /* Help tooltip */
        .comfy-param-help-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--bd);
            color: var(--t3);
            font-size: .65rem;
            cursor: help;
            flex-shrink: 0;
            position: relative;
        }

        .comfy-param-help-icon:hover::after {
            content: attr(data-tip);
            position: absolute;
            bottom: calc(100% + 6px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg2);
            color: var(--t1);
            border: 1px solid var(--bd);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: .72rem;
            line-height: 1.4;
            white-space: pre-line;
            width: max-content;
            max-width: 280px;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,.15);
            pointer-events: none;
        }

        /* Deploy progress */
        .deploy-view {
            display: none;
        }

        .deploy-view.active {
            display: block;
        }

        .deploy-content {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        .deploy-content .deploy-steps-list {
            flex: 0 0 260px;
            min-width: 200px;
            position: sticky;
            top: 20px;
        }

        .deploy-content .deploy-log {
            flex: 1;
            min-width: 0;
        }

        .deploy-step-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: clamp(6px, 0.8vw, 10px) 0;
            font-size: clamp(0.9rem, 1vw, 1.08rem);
            color: var(--t3);
        }

        .deploy-step-item.active {
            color: var(--t1);
            font-weight: 500;
        }

        .deploy-step-item.done {
            color: var(--green);
        }

        .deploy-step-item .step-icon {
            width: 24px;
            text-align: center;
        }

        .deploy-log {
            background: var(--bg2);
            border: 1px solid var(--bd);
            border-radius: var(--r);
            padding: clamp(12px, 1.5vw, 20px);
            min-height: clamp(400px, 55vh, 600px);
            max-height: clamp(500px, 70vh, 800px);
            overflow-y: auto;
            font-family: var(--mono);
            font-size: clamp(0.78rem, 0.85vw, 0.92rem);
            line-height: 1.9;
        }

        .log-line {
            white-space: pre-wrap;
            word-break: break-all;
        }

        .log-line.info {
            color: var(--t2);
        }

        .log-line.output {
            color: var(--t3);
        }

        .log-line.warn {
            color: #f59e0b;
        }

        .log-line.error {
            color: var(--red);
        }

        .log-line .log-time {
            color: var(--t3);
            margin-right: 10px;
            font-size: clamp(0.72rem, 0.78vw, 0.85rem);
        }

        /* Summary section */
        .summary-card {
            background: var(--bg3);
            border: 1px solid var(--bd);
            border-radius: var(--r);
            padding: clamp(16px, 1.8vw, 24px);
            margin-bottom: 14px;
        }

        .summary-card h4 {
            font-size: clamp(0.92rem, 1vw, 1.1rem);
            margin-bottom: 10px;
            color: var(--accent);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            font-size: clamp(0.88rem, 1vw, 1.05rem);
            padding: 4px 0;
        }

        .summary-row .label {
            color: var(--t3);
        }

        .summary-row .value {
            color: var(--t1);
        }

        /* Env hint styling */
        .env-hint {
            background: color-mix(in srgb, var(--green) 8%, var(--bg3));
            border: 1px solid color-mix(in srgb, var(--green) 25%, var(--bd));
            border-radius: 8px;
            padding: 10px 14px;
            margin-bottom: 16px;
            font-size: clamp(0.82rem, 0.9vw, 0.95rem);
            color: var(--green);
            line-height: 1.5;
        }

        .env-hint code {
            background: rgba(255, 255, 255, .08);
            padding: 1px 6px;
            border-radius: 4px;
            font-family: var(--mono);
            font-size: 0.9em;
        }

        /* Import upload area */
        .import-upload-box {
            background: var(--bg3);
            border: 2px dashed var(--bd);
            border-radius: var(--r);
            padding: clamp(20px, 2.5vw, 32px);
            text-align: center;
            transition: border-color .2s;
        }

        .import-upload-box:hover {
            border-color: var(--accent);
        }

        .import-upload-box p {
            color: var(--t2);
            margin-bottom: 12px;
            font-size: clamp(0.85rem, 0.95vw, 1rem);
        }

        .import-upload-box code {
            background: rgba(255, 255, 255, .08);
            padding: 1px 6px;
            border-radius: 4px;
            font-family: var(--mono);
            font-size: 0.9em;
        }

        .import-result {
            margin-top: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: clamp(0.82rem, 0.92vw, 0.95rem);
            line-height: 1.6;
        }

        /* Wizard remote chips */
        .wz-remote-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--bg3);
            border: 1px solid var(--bd);
            border-radius: 8px;
            padding: 6px 14px;
            font-size: .85rem;
            margin: 4px;
        }

        .wz-remote-chip .wz-rtype {
            color: var(--t3);
            font-size: .75rem;
        }

        /* Wizard sync rule panel — scrollable cards */
        .wz-rule-panel {
            margin-bottom: 16px;
        }

        .wz-rule-panel h4 {
            font-size: .95rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .wz-rule-panel .wz-rule-hint {
            font-size: .78rem;
            color: var(--t3);
            margin-bottom: 10px;
        }

        .wz-rule-row {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding-bottom: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--bd-f) transparent;
            cursor: grab;
        }

        .wz-rule-row:active {
            cursor: grabbing;
        }

        .wz-rule-row::-webkit-scrollbar {
            height: 6px;
        }

        .wz-rule-row::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 3px;
        }

        .wz-rule-row::-webkit-scrollbar-thumb {
            background: var(--bd-f);
            border-radius: 3px;
        }

        .wz-rule-row::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        .wz-rule-card {
            min-width: 200px;
            max-width: 240px;
            flex-shrink: 0;
            position: relative;
            background: var(--bg3);
            border: 2px solid var(--bd);
            border-radius: var(--r);
            padding: 14px;
            transition: all .2s;
            user-select: none;
        }

        .wz-rule-card:hover {
            border-color: var(--accent);
        }

        .wz-rule-card.selected {
            border-color: var(--accent);
            background: color-mix(in srgb, var(--accent) 10%, var(--bg3));
        }

        .wz-rule-check {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 20px;
            height: 20px;
            border: 2px solid var(--t3);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all .2s;
            font-size: 12px;
            color: transparent;
            background: var(--bg2);
        }

        .wz-rule-check:hover {
            border-color: var(--accent);
        }

        .wz-rule-card.selected .wz-rule-check {
            background: var(--accent);
            border-color: var(--accent);
            color: #fff;
        }

        .wz-rule-card .rule-name {
            font-weight: 600;
            font-size: .88rem;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-right: 24px;
        }

        .wz-rule-card .rule-method {
            font-size: .72rem;
            color: var(--t3);
            margin-bottom: 8px;
        }

        .wz-rule-card .rule-field {
            margin-bottom: 6px;
        }

        .wz-rule-card .rule-field label {
            font-size: .72rem;
            color: var(--t3);
            display: block;
            margin-bottom: 2px;
        }

        .wz-rule-card .rule-field input,
        .wz-rule-card .rule-field select {
            width: 100%;
            padding: 4px 8px;
            background: var(--bg2);
            color: var(--t1);
            border: 1px solid var(--bd);
            border-radius: 6px;
            font-size: .80rem;
        }

        .wz-rule-card .rule-local {
            font-size: .70rem;
            color: var(--t3);
            margin-top: 6px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Add remote inline form */
        .wz-add-remote-form {
            background: var(--bg3);
            border: 1px solid var(--bd);
            border-radius: var(--r);
            padding: 16px;
            margin-top: 10px;
        }

        .wz-add-remote-form .form-group {
            margin-bottom: 10px;
        }

        .wz-add-remote-form label {
            font-size: .82rem;
            color: var(--t2);
            display: block;
            margin-bottom: 3px;
        }

        .wz-add-remote-form select,
        .wz-add-remote-form input[type="text"],
        .wz-add-remote-form input[type="password"],
        .wz-add-remote-form textarea {
            width: 100%;
            padding: 8px 12px;
            background: var(--bg2);
            color: var(--t1);
            border: 1px solid var(--bd);
            border-radius: 8px;
            font-size: .85rem;
            font-family: inherit;
        }

        .wz-add-remote-form select:focus,
        .wz-add-remote-form input:focus,
        .wz-add-remote-form textarea:focus {
            border-color: var(--accent);
            outline: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .choice-grid {
                grid-template-columns: 1fr !important;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }

            .deploy-content {
                flex-direction: column;
            }

            .deploy-content .deploy-steps-list {
                flex: none;
                position: static;
            }
        }

        @media (max-width: 600px) {
            .choice-grid {
                grid-template-columns: 1fr !important;
            }
        }

        /* Material Symbols */
        @font-face {
            font-family: 'Material Symbols Outlined';
            font-style: normal;
            font-weight: 100 700;
            src: url('/static/fonts/MaterialSymbolsOutlined.woff2') format('woff2');
        }

        .ms {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 20px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            vertical-align: -3px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-feature-settings: 'liga';
            font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 20;
        }

        .ms-xs { font-size: 14px; vertical-align: -2px; font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 14; }
        .ms-sm { font-size: 18px; vertical-align: -3px; font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 18; }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            vertical-align: middle;
            margin-right: 4px;
        }

        .status-dot.online { background: var(--green) }
        .status-dot.pending { background: var(--amber) }
        .status-dot.offline { background: var(--red) }

        /* ── Light Theme ── */
        [data-theme="light"] {
            --bg1: #f0f0f4;
            --bg2: #e6e6ec;
            --bg3: #ffffff;
            --bg4: #d8d8e0;
            --bd:  #c8c8d4;
            --t1:  #1a1a2e;
            --t2:  #55556a;
            --t3:  #8888a0;
            --accent: #6b4fe0;
            --accent2: #8568ff;
            --green: #16a34a;
            --red:   #dc2626;
            --amber: #d97706;
        }
        /* ── Theme Toggle Button ── */
        .theme-toggle {
            position: fixed;
            top: 18px;
            right: 18px;
            z-index: 200;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid var(--bd);
            background: var(--bg3);
            color: var(--t2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background .2s, border-color .2s, color .2s;
            box-shadow: var(--sh);
        }
        .theme-toggle:hover { border-color: var(--accent); color: var(--accent) }
        .theme-toggle .ms { font-size: 18px; font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 18; }
